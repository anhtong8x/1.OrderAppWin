2018-08-04 08:29:35.230 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/  
2018-08-04 08:29:35.264 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:29:35.351 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:29:35.470 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__user_Id_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [adm].[UserClaim] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0"
2018-08-04 08:29:35.544 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__userId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[ConcurrencyStamp], [x].[Description], [x].[Name], [x].[NormalizedName], [x].[Type]
FROM [adm].[Role] AS [x]
WHERE EXISTS (
    SELECT 1
    FROM [adm].[UserRole] AS [m]
    WHERE ([m].[UserId] = @__userId_0) AND ([m].[RoleId] = [x].[Id]))"
2018-08-04 08:29:35.563 +07:00 [Information] Route matched with "{action = \"Index\", controller = \"Home\", area = \"\"}". Executing action "TN.UI.Controllers.HomeController.Index (TN.UI)"
2018-08-04 08:29:35.568 +07:00 [Information] Executing action method "TN.UI.Controllers.HomeController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:29:35.569 +07:00 [Information] Executed action method "TN.UI.Controllers.HomeController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 0.6475ms.
2018-08-04 08:29:35.579 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:29:35.594 +07:00 [Information] Executed ViewResult - view "Index" executed in 24.1344ms.
2018-08-04 08:29:35.594 +07:00 [Information] Executed action "TN.UI.Controllers.HomeController.Index (TN.UI)" in 30.3638ms
2018-08-04 08:29:35.594 +07:00 [Information] Request finished in 369.6796ms 200 text/html; charset=utf-8
2018-08-04 08:29:35.683 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.css?v=HnGJCmFp085jz-PBZzJQGxFv8j-3K6sYswpGTxksm5g  
2018-08-04 08:29:35.734 +07:00 [Information] Sending file. Request path: '"/Content/Admin/site.min.css"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\Content\Admin\site.min.css"'
2018-08-04 08:29:35.734 +07:00 [Information] Request finished in 51.3707ms 200 text/css
2018-08-04 08:29:35.887 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/js/script.js  
2018-08-04 08:29:35.887 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.js  
2018-08-04 08:29:35.888 +07:00 [Information] The file "/Content/Admin/site.min.js" was not modified
2018-08-04 08:29:35.888 +07:00 [Information] The file "/Content/Admin/js/script.js" was not modified
2018-08-04 08:29:35.890 +07:00 [Information] Request finished in 2.6868ms 304 application/javascript
2018-08-04 08:29:35.890 +07:00 [Information] Request finished in 2.7652ms 304 application/javascript
2018-08-04 08:29:45.972 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 08:29:45.981 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 08:29:45.981 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 08:29:45.985 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:29:45.996 +07:00 [Information] Executed DbCommand ("9"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:29:46.012 +07:00 [Information] Executed DbCommand ("8"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:29:46.020 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 38.2633ms.
2018-08-04 08:29:46.023 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 08:29:46.066 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 45.8018ms.
2018-08-04 08:29:46.066 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 84.8028ms
2018-08-04 08:29:46.066 +07:00 [Information] Request finished in 94.5653ms 200 text/html; charset=utf-8
2018-08-04 08:29:46.362 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:29:46.373 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:29:46.374 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 08:29:46.419 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:29:46.444 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:29:46.484 +07:00 [Information] Executed DbCommand ("9"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 08:29:46.501 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 08:29:46.571 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 08:29:46.581 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:29:46.583 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 208.661ms.
2018-08-04 08:29:46.587 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:29:46.592 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 7.818ms.
2018-08-04 08:29:46.592 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 218.4331ms
2018-08-04 08:29:46.592 +07:00 [Information] Request finished in 231.941ms 200 text/html; charset=utf-8
2018-08-04 08:29:52.537 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 58
2018-08-04 08:29:52.538 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:29:52.538 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "31", ""]) - Validation state: Valid
2018-08-04 08:29:52.541 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:29:52.547 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:29:52.553 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 08:29:52.558 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 08:29:52.563 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 08:29:52.569 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:29:52.570 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 31.2875ms.
2018-08-04 08:29:52.570 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:29:52.571 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.5862ms.
2018-08-04 08:29:52.571 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 32.8255ms
2018-08-04 08:29:52.571 +07:00 [Information] Request finished in 34.3907ms 200 text/html; charset=utf-8
2018-08-04 08:29:57.186 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 58
2018-08-04 08:29:57.188 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:29:57.189 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/04/2018", "31", ""]) - Validation state: Valid
2018-08-04 08:29:57.190 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:29:57.197 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:29:57.206 +07:00 [Information] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 08:29:57.212 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 08:29:57.218 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 08:29:57.223 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:29:57.224 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 35.0371ms.
2018-08-04 08:29:57.224 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:29:57.224 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.2493ms.
2018-08-04 08:29:57.224 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 36.0254ms
2018-08-04 08:29:57.225 +07:00 [Information] Request finished in 43.6125ms 200 text/html; charset=utf-8
2018-08-04 08:29:59.740 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 58
2018-08-04 08:29:59.752 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:29:59.754 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["09/04/2018", "31", ""]) - Validation state: Valid
2018-08-04 08:29:59.755 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:29:59.760 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:29:59.776 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE [m].[Id] IN (4068)"
2018-08-04 08:29:59.788 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE [m].[ConfirmationTripsId] IN (115)"
2018-08-04 08:29:59.810 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE [m].[ConfirmationTripsId] IN (115)"
2018-08-04 08:29:59.827 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:29:59.830 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 76.3102ms.
2018-08-04 08:29:59.830 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:29:59.831 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.4139ms.
2018-08-04 08:29:59.831 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 77.9304ms
2018-08-04 08:29:59.831 +07:00 [Information] Request finished in 91.0162ms 200 text/html; charset=utf-8
2018-08-04 08:34:51.658 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth  
2018-08-04 08:34:51.661 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 08:34:51.661 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" - Validation state: Valid
2018-08-04 08:34:51.661 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:34:51.666 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:34:51.673 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:34:51.681 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 19.9586ms.
2018-08-04 08:34:51.683 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonth".
2018-08-04 08:34:51.685 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonth" executed in 3.8595ms.
2018-08-04 08:34:51.685 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 24.6705ms
2018-08-04 08:34:51.686 +07:00 [Information] Request finished in 27.9102ms 200 text/html; charset=utf-8
2018-08-04 08:34:52.038 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:34:52.039 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 08:34:52.040 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" with arguments (["0", "0", "1", ""]) - Validation state: Valid
2018-08-04 08:34:52.041 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:34:52.054 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Aircon], [x].[Capacity], [x].[ContractEndDate], [x].[CreatedDate], [x].[CreatedUser], [x].[DeviceGPSId], [x].[DoorDown], [x].[DoorUp], [x].[DriverCode], [x].[Fuel], [x].[Heading], [x].[Ignition], [x].[IsAirConditioner], [x].[IsDelete], [x].[IsWorking], [x].[Lat], [x].[Lng], [x].[Lpn], [x].[Note], [x].[NumOfSeat], [x].[RegistryEndDate], [x].[SOS], [x].[Speed], [x].[Status], [x].[TrackingTime], [x].[TransportCompanyId], [x].[TransportCompanyStartDate], [x].[Type], [x].[UnderwriteEndDate], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleBrandId], [x].[VehicleFloorboardsTypeId], [x].[VehicleGroupId], [x].[YearOfManufacture]
FROM [Vehicle] AS [x]
WHERE [x].[TransportCompanyId] = @__transportCompanyId_0"
2018-08-04 08:34:52.108 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__month_1='?' (DbType = Int32), @__year_2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[VehicleId] AS [Key], COUNT(*) AS [Count]
FROM [ConfirmationTripsConfirm] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (DATEPART(month, [x].[CheckOutDate]) = @__month_1)) AND (DATEPART(year, [x].[CheckOutDate]) = @__year_2)
GROUP BY [x].[VehicleId]"
2018-08-04 08:34:52.119 +07:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:34:52.121 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 80.2507ms.
2018-08-04 08:34:52.122 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonthAjax".
2018-08-04 08:34:52.123 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonthAjax" executed in 1.7383ms.
2018-08-04 08:34:52.123 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 83.4831ms
2018-08-04 08:34:52.123 +07:00 [Information] Request finished in 85.1295ms 200 text/html; charset=utf-8
2018-08-04 08:40:51.739 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 08:40:51.741 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 08:40:51.742 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 08:40:51.743 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:51.789 +07:00 [Information] Executed DbCommand ("9"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:51.801 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:51.809 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 67.5145ms.
2018-08-04 08:40:51.810 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 08:40:51.813 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 3.0629ms.
2018-08-04 08:40:51.813 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 71.2641ms
2018-08-04 08:40:51.813 +07:00 [Information] Request finished in 74.8395ms 200 text/html; charset=utf-8
2018-08-04 08:40:52.188 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:40:52.189 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:40:52.189 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 08:40:52.191 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:52.204 +07:00 [Information] Executed DbCommand ("8"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:40:52.209 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 08:40:52.217 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 08:40:52.225 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 08:40:52.233 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:40:52.234 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 43.9582ms.
2018-08-04 08:40:52.234 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:40:52.235 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.5395ms.
2018-08-04 08:40:52.235 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 45.7686ms
2018-08-04 08:40:52.235 +07:00 [Information] Request finished in 47.4085ms 200 text/html; charset=utf-8
2018-08-04 08:40:53.795 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth  
2018-08-04 08:40:53.797 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 08:40:53.797 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" - Validation state: Valid
2018-08-04 08:40:53.798 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:53.805 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:53.812 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:53.821 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 23.633ms.
2018-08-04 08:40:53.821 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonth".
2018-08-04 08:40:53.824 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonth" executed in 2.6325ms.
2018-08-04 08:40:53.824 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 27.0305ms
2018-08-04 08:40:53.824 +07:00 [Information] Request finished in 30.1422ms 200 text/html; charset=utf-8
2018-08-04 08:40:54.080 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:40:54.081 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 08:40:54.081 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" with arguments (["0", "0", "1", ""]) - Validation state: Valid
2018-08-04 08:40:54.081 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:54.092 +07:00 [Information] Executed DbCommand ("9"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Aircon], [x].[Capacity], [x].[ContractEndDate], [x].[CreatedDate], [x].[CreatedUser], [x].[DeviceGPSId], [x].[DoorDown], [x].[DoorUp], [x].[DriverCode], [x].[Fuel], [x].[Heading], [x].[Ignition], [x].[IsAirConditioner], [x].[IsDelete], [x].[IsWorking], [x].[Lat], [x].[Lng], [x].[Lpn], [x].[Note], [x].[NumOfSeat], [x].[RegistryEndDate], [x].[SOS], [x].[Speed], [x].[Status], [x].[TrackingTime], [x].[TransportCompanyId], [x].[TransportCompanyStartDate], [x].[Type], [x].[UnderwriteEndDate], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleBrandId], [x].[VehicleFloorboardsTypeId], [x].[VehicleGroupId], [x].[YearOfManufacture]
FROM [Vehicle] AS [x]
WHERE [x].[TransportCompanyId] = @__transportCompanyId_0"
2018-08-04 08:40:54.148 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__month_1='?' (DbType = Int32), @__year_2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[VehicleId] AS [Key], COUNT(*) AS [Count]
FROM [ConfirmationTripsConfirm] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (DATEPART(month, [x].[CheckOutDate]) = @__month_1)) AND (DATEPART(year, [x].[CheckOutDate]) = @__year_2)
GROUP BY [x].[VehicleId]"
2018-08-04 08:40:54.160 +07:00 [Information] Executed DbCommand ("10"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:40:54.162 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 80.4499ms.
2018-08-04 08:40:54.162 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonthAjax".
2018-08-04 08:40:54.162 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonthAjax" executed in 0.4323ms.
2018-08-04 08:40:54.162 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 81.5074ms
2018-08-04 08:40:54.162 +07:00 [Information] Request finished in 82.8678ms 200 text/html; charset=utf-8
2018-08-04 08:40:55.126 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 08:40:55.128 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 08:40:55.128 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 08:40:55.129 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:55.135 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:55.143 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:55.149 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 21.1926ms.
2018-08-04 08:40:55.150 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 08:40:55.154 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 3.921ms.
2018-08-04 08:40:55.154 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 25.6755ms
2018-08-04 08:40:55.154 +07:00 [Information] Request finished in 28.304ms 200 text/html; charset=utf-8
2018-08-04 08:40:55.401 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:40:55.403 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:40:55.403 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 08:40:55.404 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:55.414 +07:00 [Information] Executed DbCommand ("9"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:40:55.421 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 08:40:55.427 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 08:40:55.440 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 08:40:55.448 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:40:55.449 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 45.4888ms.
2018-08-04 08:40:55.449 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:40:55.450 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.9133ms.
2018-08-04 08:40:55.450 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 47.29ms
2018-08-04 08:40:55.450 +07:00 [Information] Request finished in 49.3431ms 200 text/html; charset=utf-8
2018-08-04 08:40:56.320 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth  
2018-08-04 08:40:56.322 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 08:40:56.322 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" - Validation state: Valid
2018-08-04 08:40:56.322 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:56.329 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:56.336 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:56.342 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 20.0375ms.
2018-08-04 08:40:56.342 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonth".
2018-08-04 08:40:56.345 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonth" executed in 2.4413ms.
2018-08-04 08:40:56.345 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 23.3406ms
2018-08-04 08:40:56.346 +07:00 [Information] Request finished in 25.8306ms 200 text/html; charset=utf-8
2018-08-04 08:40:56.577 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:40:56.578 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 08:40:56.579 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" with arguments (["0", "0", "1", ""]) - Validation state: Valid
2018-08-04 08:40:56.580 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:56.590 +07:00 [Information] Executed DbCommand ("9"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Aircon], [x].[Capacity], [x].[ContractEndDate], [x].[CreatedDate], [x].[CreatedUser], [x].[DeviceGPSId], [x].[DoorDown], [x].[DoorUp], [x].[DriverCode], [x].[Fuel], [x].[Heading], [x].[Ignition], [x].[IsAirConditioner], [x].[IsDelete], [x].[IsWorking], [x].[Lat], [x].[Lng], [x].[Lpn], [x].[Note], [x].[NumOfSeat], [x].[RegistryEndDate], [x].[SOS], [x].[Speed], [x].[Status], [x].[TrackingTime], [x].[TransportCompanyId], [x].[TransportCompanyStartDate], [x].[Type], [x].[UnderwriteEndDate], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleBrandId], [x].[VehicleFloorboardsTypeId], [x].[VehicleGroupId], [x].[YearOfManufacture]
FROM [Vehicle] AS [x]
WHERE [x].[TransportCompanyId] = @__transportCompanyId_0"
2018-08-04 08:40:56.640 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__month_1='?' (DbType = Int32), @__year_2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[VehicleId] AS [Key], COUNT(*) AS [Count]
FROM [ConfirmationTripsConfirm] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (DATEPART(month, [x].[CheckOutDate]) = @__month_1)) AND (DATEPART(year, [x].[CheckOutDate]) = @__year_2)
GROUP BY [x].[VehicleId]"
2018-08-04 08:40:56.643 +07:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:40:56.645 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 66.1531ms.
2018-08-04 08:40:56.646 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonthAjax".
2018-08-04 08:40:56.648 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonthAjax" executed in 1.8665ms.
2018-08-04 08:40:56.648 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 69.8431ms
2018-08-04 08:40:56.649 +07:00 [Information] Request finished in 71.9583ms 200 text/html; charset=utf-8
2018-08-04 08:40:58.159 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 08:40:58.161 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 08:40:58.161 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 08:40:58.163 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:58.175 +07:00 [Information] Executed DbCommand ("11"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:58.232 +07:00 [Information] Executed DbCommand ("56"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:40:58.559 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 397.5074ms.
2018-08-04 08:40:58.559 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 08:40:58.562 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 2.6029ms.
2018-08-04 08:40:58.562 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 400.6756ms
2018-08-04 08:40:58.562 +07:00 [Information] Request finished in 403.2403ms 200 text/html; charset=utf-8
2018-08-04 08:40:58.828 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:40:58.830 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:40:58.830 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 08:40:58.831 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:40:58.871 +07:00 [Information] Executed DbCommand ("39"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:40:58.883 +07:00 [Information] Executed DbCommand ("9"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 08:40:58.896 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 08:40:58.902 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 08:40:58.909 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:40:58.910 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 79.184ms.
2018-08-04 08:40:58.911 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:40:58.911 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.6023ms.
2018-08-04 08:40:58.911 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 81.2011ms
2018-08-04 08:40:58.911 +07:00 [Information] Request finished in 83.0452ms 200 text/html; charset=utf-8
2018-08-04 08:54:54.093 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Manager/DeviceManager  
2018-08-04 08:54:54.115 +07:00 [Information] Route matched with "{area = \"Manager\", action = \"Index\", controller = \"DeviceManager\"}". Executing action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)"
2018-08-04 08:54:54.116 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:54:54.421 +07:00 [Information] Executed DbCommand ("62"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:54:54.435 +07:00 [Information] Executing action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:54:54.436 +07:00 [Information] Executed action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 0.9913ms.
2018-08-04 08:54:54.457 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:54:54.493 +07:00 [Information] Executed ViewResult - view "Index" executed in 56.3975ms.
2018-08-04 08:54:54.493 +07:00 [Information] Executed action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)" in 377.9315ms
2018-08-04 08:54:54.493 +07:00 [Information] Request finished in 399.7263ms 200 text/html; charset=utf-8
2018-08-04 08:54:54.910 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Manager/DeviceManager application/x-www-form-urlencoded; charset=UTF-8 47
2018-08-04 08:54:54.921 +07:00 [Information] Route matched with "{area = \"Manager\", action = \"Index\", controller = \"DeviceManager\"}". Executing action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)"
2018-08-04 08:54:54.922 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:54:55.002 +07:00 [Information] Executed DbCommand ("78"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:54:55.004 +07:00 [Information] Executing action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)" with arguments (["1", "10", "", "asc", "name"]) - Validation state: Valid
2018-08-04 08:54:55.236 +07:00 [Information] Executed DbCommand ("121"ms) [Parameters=["@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [y].[Id], [y].[Aircon], [y].[Capacity], [y].[ContractEndDate], [y].[CreatedDate], [y].[CreatedUser], [y].[DeviceGPSId], [y].[DoorDown], [y].[DoorUp], [y].[DriverCode], [y].[Fuel], [y].[Heading], [y].[Ignition], [y].[IsAirConditioner], [y].[IsDelete], [y].[IsWorking], [y].[Lat], [y].[Lng], [y].[Lpn], [y].[Note], [y].[NumOfSeat], [y].[RegistryEndDate], [y].[SOS], [y].[Speed], [y].[Status], [y].[TrackingTime], [y].[TransportCompanyId], [y].[TransportCompanyStartDate], [y].[Type], [y].[UnderwriteEndDate], [y].[UpdatedDate], [y].[UpdatedUser], [y].[VehicleBrandId], [y].[VehicleFloorboardsTypeId], [y].[VehicleGroupId], [y].[YearOfManufacture], [m].[Id] AS [Id0], [m].[ConfigString], [m].[CreatedDate] AS [CreatedDate0], [m].[CreatedUser] AS [CreatedUser0], [m].[IMEI], [m].[IsDelete] AS [IsDelete0], [m].[Name], [m].[Note] AS [Note0], [m].[SoftwareVersion], [m].[StartDate], [m].[Status] AS [Status0], [m].[TransportCompanyId] AS [TransportCompanyId0], [m].[UpdatedDate] AS [UpdatedDate0], [m].[UpdatedUser] AS [UpdatedUser0], [m].[VehicleId], [m].[WarrantyPeriod]
FROM [Device] AS [m]
LEFT JOIN [Vehicle] AS [y] ON [m].[VehicleId] = [y].[Id]
WHERE [m].[IsDelete] = 0
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY"
2018-08-04 08:54:55.372 +07:00 [Information] Executed DbCommand ("61"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Device] AS [m]
LEFT JOIN [Vehicle] AS [y] ON [m].[VehicleId] = [y].[Id]
WHERE [m].[IsDelete] = 0"
2018-08-04 08:54:55.401 +07:00 [Information] Executed action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 395.6675ms.
2018-08-04 08:54:55.408 +07:00 [Information] Executing ViewResult, running view "IndexAjax".
2018-08-04 08:54:55.430 +07:00 [Information] Executed ViewResult - view "IndexAjax" executed in 28.6249ms.
2018-08-04 08:54:55.430 +07:00 [Information] Executed action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)" in 508.4068ms
2018-08-04 08:54:55.430 +07:00 [Information] Request finished in 519.759ms 200 text/html; charset=utf-8
2018-08-04 08:54:59.206 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Log/LogManager  
2018-08-04 08:54:59.216 +07:00 [Information] Route matched with "{area = \"Log\", action = \"Index\", controller = \"LogManager\"}". Executing action "TN.UI.Areas.Log.Controllers.LogManagerController.Index (TN.UI)"
2018-08-04 08:54:59.217 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:54:59.269 +07:00 [Information] Executed DbCommand ("51"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:54:59.285 +07:00 [Information] Executing action method "TN.UI.Areas.Log.Controllers.LogManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:54:59.356 +07:00 [Information] Executed DbCommand ("59"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[AreaId], [m].[GroupId], [m].[Name], [m].[Order], [m].[Status]
FROM [adm].[RoleController] AS [m]
WHERE [m].[Status] = 1"
2018-08-04 08:54:59.382 +07:00 [Information] Executed action method "TN.UI.Areas.Log.Controllers.LogManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 96.5814ms.
2018-08-04 08:54:59.463 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:54:59.508 +07:00 [Information] Executed ViewResult - view "Index" executed in 125.5653ms.
2018-08-04 08:54:59.508 +07:00 [Information] Executed action "TN.UI.Areas.Log.Controllers.LogManagerController.Index (TN.UI)" in 291.3599ms
2018-08-04 08:54:59.509 +07:00 [Information] Request finished in 303.2919ms 200 text/html; charset=utf-8
2018-08-04 08:54:59.730 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Log/LogManager application/x-www-form-urlencoded; charset=UTF-8 117
2018-08-04 08:54:59.745 +07:00 [Information] Route matched with "{area = \"Log\", action = \"Index\", controller = \"LogManager\"}". Executing action "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)"
2018-08-04 08:54:59.746 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:00.355 +07:00 [Information] Executed DbCommand ("608"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:00.356 +07:00 [Information] Executing action method "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)" with arguments (["1", "10", "", "", "", "04/08/2018", "04/08/2018", "desc", "createdDate"]) - Validation state: Valid
2018-08-04 08:55:00.465 +07:00 [Information] Executed DbCommand ("99"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [r].[Id], [r].[AreaId], [r].[GroupId], [r].[Name], [r].[Order], [r].[Status]
FROM [adm].[RoleController] AS [r]"
2018-08-04 08:55:00.639 +07:00 [Information] Executed DbCommand ("152"ms) [Parameters=["@___startTime_Value_3='?' (DbType = DateTime2), @___endTime_Value_4='?' (DbType = DateTime2), @__p_5='?' (DbType = Int32), @__p_6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Action], [m].[Object], [m].[ObjectType], [m].[Status], [m].[Type], [m].[Timestamp], [m].[SystemUser], [m].[ObjectId], [m].[SystemUserId], [m].[CreatedDate]
FROM [adm].[Log] AS [m]
WHERE ([m].[CreatedDate] >= @___startTime_Value_3) AND ([m].[CreatedDate] <= @___endTime_Value_4)
ORDER BY [m].[CreatedDate] DESC
OFFSET @__p_5 ROWS FETCH NEXT @__p_6 ROWS ONLY"
2018-08-04 08:55:01.089 +07:00 [Information] Executed DbCommand ("437"ms) [Parameters=["@___startTime_Value_3='?' (DbType = DateTime2), @___endTime_Value_4='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [adm].[Log] AS [m]
WHERE ([m].[CreatedDate] >= @___startTime_Value_3) AND ([m].[CreatedDate] <= @___endTime_Value_4)"
2018-08-04 08:55:01.092 +07:00 [Information] Executed action method "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 735.4893ms.
2018-08-04 08:55:01.120 +07:00 [Information] Executing ViewResult, running view "IndexAjax".
2018-08-04 08:55:01.129 +07:00 [Information] Executed ViewResult - view "IndexAjax" executed in 36.5458ms.
2018-08-04 08:55:01.129 +07:00 [Information] Executed action "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)" in 1383.8687ms
2018-08-04 08:55:01.129 +07:00 [Information] Request finished in 1399.7229ms 200 text/html; charset=utf-8
2018-08-04 08:55:05.265 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Log/LogManager application/x-www-form-urlencoded; charset=UTF-8 117
2018-08-04 08:55:05.266 +07:00 [Information] Route matched with "{area = \"Log\", action = \"Index\", controller = \"LogManager\"}". Executing action "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)"
2018-08-04 08:55:05.267 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:05.637 +07:00 [Information] Executed DbCommand ("369"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:05.639 +07:00 [Information] Executing action method "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)" with arguments (["1", "10", "", "", "", "04/08/2018", "04/08/2018", "desc", "createdDate"]) - Validation state: Valid
2018-08-04 08:55:05.743 +07:00 [Information] Executed DbCommand ("104"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [r].[Id], [r].[AreaId], [r].[GroupId], [r].[Name], [r].[Order], [r].[Status]
FROM [adm].[RoleController] AS [r]"
2018-08-04 08:55:05.856 +07:00 [Information] Executed DbCommand ("109"ms) [Parameters=["@___startTime_Value_3='?' (DbType = DateTime2), @___endTime_Value_4='?' (DbType = DateTime2), @__p_5='?' (DbType = Int32), @__p_6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Action], [m].[Object], [m].[ObjectType], [m].[Status], [m].[Type], [m].[Timestamp], [m].[SystemUser], [m].[ObjectId], [m].[SystemUserId], [m].[CreatedDate]
FROM [adm].[Log] AS [m]
WHERE ([m].[CreatedDate] >= @___startTime_Value_3) AND ([m].[CreatedDate] <= @___endTime_Value_4)
ORDER BY [m].[CreatedDate] DESC
OFFSET @__p_5 ROWS FETCH NEXT @__p_6 ROWS ONLY"
2018-08-04 08:55:05.961 +07:00 [Information] Executed DbCommand ("101"ms) [Parameters=["@___startTime_Value_3='?' (DbType = DateTime2), @___endTime_Value_4='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [adm].[Log] AS [m]
WHERE ([m].[CreatedDate] >= @___startTime_Value_3) AND ([m].[CreatedDate] <= @___endTime_Value_4)"
2018-08-04 08:55:05.961 +07:00 [Information] Executed action method "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 322.2841ms.
2018-08-04 08:55:05.962 +07:00 [Information] Executing ViewResult, running view "IndexAjax".
2018-08-04 08:55:05.962 +07:00 [Information] Executed ViewResult - view "IndexAjax" executed in 0.5097ms.
2018-08-04 08:55:05.962 +07:00 [Information] Executed action "TN.UI.Areas.Log.Controllers.LogManagerController.IndexPost (TN.UI)" in 695.7439ms
2018-08-04 08:55:05.962 +07:00 [Information] Request finished in 697.4298ms 200 text/html; charset=utf-8
2018-08-04 08:55:08.000 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/User/UserManager  
2018-08-04 08:55:08.006 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"UserManager\"}". Executing action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)"
2018-08-04 08:55:08.007 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:08.069 +07:00 [Information] Executed DbCommand ("61"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:08.071 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:55:08.133 +07:00 [Information] Executed DbCommand ("52"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[Type]
FROM [adm].[Role] AS [r]"
2018-08-04 08:55:08.152 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 80.7624ms.
2018-08-04 08:55:08.166 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:55:08.217 +07:00 [Information] Executed ViewResult - view "Index" executed in 64.6319ms.
2018-08-04 08:55:08.217 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" in 210.5903ms
2018-08-04 08:55:08.217 +07:00 [Information] Request finished in 217.5797ms 200 text/html; charset=utf-8
2018-08-04 08:55:08.451 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/User/UserManager application/x-www-form-urlencoded; charset=UTF-8 67
2018-08-04 08:55:08.491 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"UserManager\"}". Executing action "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)"
2018-08-04 08:55:08.492 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:08.559 +07:00 [Information] Executed DbCommand ("66"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:08.560 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)" with arguments (["1", "10", "", "", "", "", "asc", "username"]) - Validation state: Valid
2018-08-04 08:55:08.677 +07:00 [Information] Executed DbCommand ("83"ms) [Parameters=["@__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[AccessFailedCount], [m].[Avatar], [m].[ConcurrencyStamp], [m].[CreatedDate], [m].[CreatedUserId], [m].[DisplayName], [m].[Email], [m].[EmailConfirmed], [m].[IsLock], [m].[IsReLogin], [m].[IsSuperAdmin], [m].[LockoutEnabled], [m].[LockoutEnd], [m].[NormalizedEmail], [m].[NormalizedUserName], [m].[Note], [m].[NoteLock], [m].[PasswordHash], [m].[PhoneNumber], [m].[PhoneNumberConfirmed], [m].[RoleParents], [m].[RoleSchool], [m].[RoleTransportCompany], [m].[SecurityStamp], [m].[TwoFactorEnabled], [m].[UpdatedDate], [m].[UpdatedUserId], [m].[UserName]
FROM [adm].[User] AS [m]
WHERE [m].[IsSuperAdmin] = 0
ORDER BY [m].[UserName]
OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY"
2018-08-04 08:55:08.694 +07:00 [Warning] The LINQ expression '"where ([x].Id == [m].UserId)"' could not be translated and will be evaluated locally.
2018-08-04 08:55:08.695 +07:00 [Warning] The LINQ expression '"Any()"' could not be translated and will be evaluated locally.
2018-08-04 08:55:08.695 +07:00 [Warning] The LINQ expression '"where {from ApplicationUser x in __currentData_0 where ([x].Id == [m].UserId) select [x] => Any()}"' could not be translated and will be evaluated locally.
2018-08-04 08:55:08.695 +07:00 [Warning] The LINQ expression '"where ([x].Id == [m].UserId)"' could not be translated and will be evaluated locally.
2018-08-04 08:55:08.700 +07:00 [Warning] The LINQ expression '"Any()"' could not be translated and will be evaluated locally.
2018-08-04 08:55:08.706 +07:00 [Warning] The LINQ expression '"join ApplicationRole entry in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[TN.Domain.Model.ApplicationRole]) on [m].RoleId equals [entry].Id"' could not be translated and will be evaluated locally.
2018-08-04 08:55:08.846 +07:00 [Information] Executed DbCommand ("74"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[UserId], [m].[RoleId]
FROM [adm].[UserRole] AS [m]"
2018-08-04 08:55:08.959 +07:00 [Information] Executed DbCommand ("87"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [entry].[Id], [entry].[ConcurrencyStamp], [entry].[Description], [entry].[Name], [entry].[NormalizedName], [entry].[Type]
FROM [adm].[Role] AS [entry]"
2018-08-04 08:55:09.080 +07:00 [Information] Executed DbCommand ("78"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [adm].[User] AS [m]
WHERE [m].[IsSuperAdmin] = 0"
2018-08-04 08:55:09.086 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 525.8039ms.
2018-08-04 08:55:09.089 +07:00 [Information] Executing ViewResult, running view "IndexAjax".
2018-08-04 08:55:09.099 +07:00 [Information] Executed ViewResult - view "IndexAjax" executed in 12.4557ms.
2018-08-04 08:55:09.099 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)" in 607.9449ms
2018-08-04 08:55:09.099 +07:00 [Information] Request finished in 648.5743ms 200 text/html; charset=utf-8
2018-08-04 08:55:09.112 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/User/UserManager  
2018-08-04 08:55:09.113 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"UserManager\"}". Executing action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)"
2018-08-04 08:55:09.113 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:09.177 +07:00 [Information] Executed DbCommand ("63"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:09.178 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:55:09.263 +07:00 [Information] Executed DbCommand ("84"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[Type]
FROM [adm].[Role] AS [r]"
2018-08-04 08:55:09.263 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 85.156ms.
2018-08-04 08:55:09.263 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:55:09.265 +07:00 [Information] Executed ViewResult - view "Index" executed in 1.5153ms.
2018-08-04 08:55:09.265 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" in 152.3219ms
2018-08-04 08:55:09.265 +07:00 [Information] Request finished in 153.5213ms 200 text/html; charset=utf-8
2018-08-04 08:55:09.277 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/images/no-avatar.jpg  
2018-08-04 08:55:09.346 +07:00 [Information] Sending file. Request path: '"/Content/Admin/images/no-avatar.jpg"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\Content\Admin\images\no-avatar.jpg"'
2018-08-04 08:55:09.346 +07:00 [Information] Request finished in 69.2279ms 200 image/jpeg
2018-08-04 08:55:10.838 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/User/RoleManager  
2018-08-04 08:55:10.845 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"RoleManager\"}". Executing action "TN.UI.Areas.User.Controllers.RoleManagerController.Index (TN.UI)"
2018-08-04 08:55:10.845 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:10.969 +07:00 [Information] Executed DbCommand ("123"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:10.978 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.RoleManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:55:10.979 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.RoleManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 0.6804ms.
2018-08-04 08:55:11.003 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:55:11.036 +07:00 [Information] Executed ViewResult - view "Index" executed in 57.1502ms.
2018-08-04 08:55:11.036 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.RoleManagerController.Index (TN.UI)" in 191.4739ms
2018-08-04 08:55:11.037 +07:00 [Information] Request finished in 198.9754ms 200 text/html; charset=utf-8
2018-08-04 08:55:11.237 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/User/RoleManager application/x-www-form-urlencoded; charset=UTF-8 47
2018-08-04 08:55:11.248 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"RoleManager\"}". Executing action "TN.UI.Areas.User.Controllers.RoleManagerController.IndexPost (TN.UI)"
2018-08-04 08:55:11.256 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:11.847 +07:00 [Information] Executed DbCommand ("588"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:11.851 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.RoleManagerController.IndexPost (TN.UI)" with arguments (["1", "10", "", "asc", "name"]) - Validation state: Valid
2018-08-04 08:55:11.998 +07:00 [Information] Executed DbCommand ("109"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [adm].[Role] AS [m]"
2018-08-04 08:55:12.092 +07:00 [Information] Executed DbCommand ("86"ms) [Parameters=["@__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[ConcurrencyStamp], [m].[Description], [m].[Name], [m].[NormalizedName], [m].[Type]
FROM [adm].[Role] AS [m]
ORDER BY [m].[Name]
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY"
2018-08-04 08:55:12.094 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.RoleManagerController.IndexPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 243.4827ms.
2018-08-04 08:55:12.098 +07:00 [Information] Executing ViewResult, running view "IndexAjax".
2018-08-04 08:55:12.164 +07:00 [Information] Executed ViewResult - view "IndexAjax" executed in 69.8977ms.
2018-08-04 08:55:12.165 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.RoleManagerController.IndexPost (TN.UI)" in 910.5565ms
2018-08-04 08:55:12.165 +07:00 [Information] Request finished in 928.0399ms 200 text/html; charset=utf-8
2018-08-04 08:55:12.753 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/User/UserManager  
2018-08-04 08:55:12.754 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"UserManager\"}". Executing action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)"
2018-08-04 08:55:12.755 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:12.832 +07:00 [Information] Executed DbCommand ("75"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:12.833 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:55:12.916 +07:00 [Information] Executed DbCommand ("83"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[Type]
FROM [adm].[Role] AS [r]"
2018-08-04 08:55:12.917 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 83.7015ms.
2018-08-04 08:55:12.917 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:55:12.918 +07:00 [Information] Executed ViewResult - view "Index" executed in 1.3984ms.
2018-08-04 08:55:12.918 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" in 164.1522ms
2018-08-04 08:55:12.919 +07:00 [Information] Request finished in 165.6331ms 200 text/html; charset=utf-8
2018-08-04 08:55:13.137 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/User/UserManager application/x-www-form-urlencoded; charset=UTF-8 67
2018-08-04 08:55:13.138 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"UserManager\"}". Executing action "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)"
2018-08-04 08:55:13.138 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:13.301 +07:00 [Information] Executed DbCommand ("161"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:13.302 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)" with arguments (["1", "10", "", "", "", "", "asc", "username"]) - Validation state: Valid
2018-08-04 08:55:13.366 +07:00 [Information] Executed DbCommand ("61"ms) [Parameters=["@__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[AccessFailedCount], [m].[Avatar], [m].[ConcurrencyStamp], [m].[CreatedDate], [m].[CreatedUserId], [m].[DisplayName], [m].[Email], [m].[EmailConfirmed], [m].[IsLock], [m].[IsReLogin], [m].[IsSuperAdmin], [m].[LockoutEnabled], [m].[LockoutEnd], [m].[NormalizedEmail], [m].[NormalizedUserName], [m].[Note], [m].[NoteLock], [m].[PasswordHash], [m].[PhoneNumber], [m].[PhoneNumberConfirmed], [m].[RoleParents], [m].[RoleSchool], [m].[RoleTransportCompany], [m].[SecurityStamp], [m].[TwoFactorEnabled], [m].[UpdatedDate], [m].[UpdatedUserId], [m].[UserName]
FROM [adm].[User] AS [m]
WHERE [m].[IsSuperAdmin] = 0
ORDER BY [m].[UserName]
OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY"
2018-08-04 08:55:13.422 +07:00 [Information] Executed DbCommand ("52"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[UserId], [m].[RoleId]
FROM [adm].[UserRole] AS [m]"
2018-08-04 08:55:13.460 +07:00 [Information] Executed DbCommand ("37"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [entry].[Id], [entry].[ConcurrencyStamp], [entry].[Description], [entry].[Name], [entry].[NormalizedName], [entry].[Type]
FROM [adm].[Role] AS [entry]"
2018-08-04 08:55:13.490 +07:00 [Information] Executed DbCommand ("28"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [adm].[User] AS [m]
WHERE [m].[IsSuperAdmin] = 0"
2018-08-04 08:55:13.491 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 188.4594ms.
2018-08-04 08:55:13.491 +07:00 [Information] Executing ViewResult, running view "IndexAjax".
2018-08-04 08:55:13.492 +07:00 [Information] Executed ViewResult - view "IndexAjax" executed in 0.8099ms.
2018-08-04 08:55:13.492 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.UserManagerController.IndexPost (TN.UI)" in 353.8232ms
2018-08-04 08:55:13.492 +07:00 [Information] Request finished in 355.2741ms 200 text/html; charset=utf-8
2018-08-04 08:55:13.518 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/User/UserManager  
2018-08-04 08:55:13.519 +07:00 [Information] Route matched with "{area = \"User\", action = \"Index\", controller = \"UserManager\"}". Executing action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)"
2018-08-04 08:55:13.520 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:13.549 +07:00 [Information] Executed DbCommand ("27"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:13.551 +07:00 [Information] Executing action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:55:13.607 +07:00 [Information] Executed DbCommand ("55"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[Type]
FROM [adm].[Role] AS [r]"
2018-08-04 08:55:13.607 +07:00 [Information] Executed action method "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 56.3123ms.
2018-08-04 08:55:13.607 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:55:13.609 +07:00 [Information] Executed ViewResult - view "Index" executed in 1.4794ms.
2018-08-04 08:55:13.609 +07:00 [Information] Executed action "TN.UI.Areas.User.Controllers.UserManagerController.Index (TN.UI)" in 90.0219ms
2018-08-04 08:55:13.609 +07:00 [Information] Request finished in 91.4418ms 200 text/html; charset=utf-8
2018-08-04 08:55:15.126 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Manager/DeviceManager  
2018-08-04 08:55:15.128 +07:00 [Information] Route matched with "{area = \"Manager\", action = \"Index\", controller = \"DeviceManager\"}". Executing action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)"
2018-08-04 08:55:15.129 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:15.193 +07:00 [Information] Executed DbCommand ("62"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:15.193 +07:00 [Information] Executing action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)" - Validation state: Valid
2018-08-04 08:55:15.193 +07:00 [Information] Executed action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 0.0116ms.
2018-08-04 08:55:15.194 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 08:55:15.195 +07:00 [Information] Executed ViewResult - view "Index" executed in 1.3985ms.
2018-08-04 08:55:15.195 +07:00 [Information] Executed action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.Index (TN.UI)" in 66.8486ms
2018-08-04 08:55:15.195 +07:00 [Information] Request finished in 69.0003ms 200 text/html; charset=utf-8
2018-08-04 08:55:15.401 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Manager/DeviceManager application/x-www-form-urlencoded; charset=UTF-8 47
2018-08-04 08:55:15.402 +07:00 [Information] Route matched with "{area = \"Manager\", action = \"Index\", controller = \"DeviceManager\"}". Executing action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)"
2018-08-04 08:55:15.404 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:15.493 +07:00 [Information] Executed DbCommand ("87"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 08:55:15.494 +07:00 [Information] Executing action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)" with arguments (["1", "10", "", "asc", "name"]) - Validation state: Valid
2018-08-04 08:55:15.544 +07:00 [Information] Executed DbCommand ("49"ms) [Parameters=["@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [y].[Id], [y].[Aircon], [y].[Capacity], [y].[ContractEndDate], [y].[CreatedDate], [y].[CreatedUser], [y].[DeviceGPSId], [y].[DoorDown], [y].[DoorUp], [y].[DriverCode], [y].[Fuel], [y].[Heading], [y].[Ignition], [y].[IsAirConditioner], [y].[IsDelete], [y].[IsWorking], [y].[Lat], [y].[Lng], [y].[Lpn], [y].[Note], [y].[NumOfSeat], [y].[RegistryEndDate], [y].[SOS], [y].[Speed], [y].[Status], [y].[TrackingTime], [y].[TransportCompanyId], [y].[TransportCompanyStartDate], [y].[Type], [y].[UnderwriteEndDate], [y].[UpdatedDate], [y].[UpdatedUser], [y].[VehicleBrandId], [y].[VehicleFloorboardsTypeId], [y].[VehicleGroupId], [y].[YearOfManufacture], [m].[Id] AS [Id0], [m].[ConfigString], [m].[CreatedDate] AS [CreatedDate0], [m].[CreatedUser] AS [CreatedUser0], [m].[IMEI], [m].[IsDelete] AS [IsDelete0], [m].[Name], [m].[Note] AS [Note0], [m].[SoftwareVersion], [m].[StartDate], [m].[Status] AS [Status0], [m].[TransportCompanyId] AS [TransportCompanyId0], [m].[UpdatedDate] AS [UpdatedDate0], [m].[UpdatedUser] AS [UpdatedUser0], [m].[VehicleId], [m].[WarrantyPeriod]
FROM [Device] AS [m]
LEFT JOIN [Vehicle] AS [y] ON [m].[VehicleId] = [y].[Id]
WHERE [m].[IsDelete] = 0
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY"
2018-08-04 08:55:15.575 +07:00 [Information] Executed DbCommand ("30"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Device] AS [m]
LEFT JOIN [Vehicle] AS [y] ON [m].[VehicleId] = [y].[Id]
WHERE [m].[IsDelete] = 0"
2018-08-04 08:55:15.576 +07:00 [Information] Executed action method "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 81.6795ms.
2018-08-04 08:55:15.576 +07:00 [Information] Executing ViewResult, running view "IndexAjax".
2018-08-04 08:55:15.577 +07:00 [Information] Executed ViewResult - view "IndexAjax" executed in 1.2744ms.
2018-08-04 08:55:15.578 +07:00 [Information] Executed action "TN.UI.Areas.Manager.Controllers.DeviceManagerController.IndexPost (TN.UI)" in 175.4028ms
2018-08-04 08:55:15.578 +07:00 [Information] Request finished in 177.0473ms 200 text/html; charset=utf-8
2018-08-04 08:55:18.344 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 08:55:18.345 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 08:55:18.345 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 08:55:18.346 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:18.352 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:55:18.363 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 08:55:18.373 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 27.7456ms.
2018-08-04 08:55:18.374 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 08:55:18.376 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 2.3611ms.
2018-08-04 08:55:18.376 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 30.742ms
2018-08-04 08:55:18.376 +07:00 [Information] Request finished in 32.9144ms 200 text/html; charset=utf-8
2018-08-04 08:55:18.637 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 08:55:18.639 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 08:55:18.639 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 08:55:18.640 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 08:55:18.660 +07:00 [Information] Executed DbCommand ("18"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 08:55:18.669 +07:00 [Information] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 08:55:18.678 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 08:55:18.689 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 08:55:18.693 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 08:55:18.694 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 55.1529ms.
2018-08-04 08:55:18.695 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 08:55:18.695 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.3971ms.
2018-08-04 08:55:18.695 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 56.4648ms
2018-08-04 08:55:18.695 +07:00 [Information] Request finished in 58.4904ms 200 text/html; charset=utf-8
2018-08-04 11:08:32.401 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 11:08:33.336 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:08:33.615 +07:00 [Information] Executed DbCommand ("13"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 11:08:33.788 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__user_Id_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [adm].[UserClaim] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0"
2018-08-04 11:08:33.826 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__userId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[ConcurrencyStamp], [x].[Description], [x].[Name], [x].[NormalizedName], [x].[Type]
FROM [adm].[Role] AS [x]
WHERE EXISTS (
    SELECT 1
    FROM [adm].[UserRole] AS [m]
    WHERE ([m].[UserId] = @__userId_0) AND ([m].[RoleId] = [x].[Id]))"
2018-08-04 11:08:34.459 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:08:34.473 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:08:34.502 +07:00 [Information] Executed DbCommand ("13"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:08:34.548 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:08:34.583 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 105.6461ms.
2018-08-04 11:08:34.623 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:08:34.808 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 210.8352ms.
2018-08-04 11:08:34.811 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 350.8587ms
2018-08-04 11:08:34.835 +07:00 [Information] Request finished in 2438.7666ms 200 text/html; charset=utf-8
2018-08-04 11:08:34.852 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.css?v=HnGJCmFp085jz-PBZzJQGxFv8j-3K6sYswpGTxksm5g  
2018-08-04 11:08:34.886 +07:00 [Information] Sending file. Request path: '"/Content/Admin/site.min.css"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\Content\Admin\site.min.css"'
2018-08-04 11:08:34.887 +07:00 [Information] Request finished in 34.3769ms 200 text/css
2018-08-04 11:08:34.893 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.js  
2018-08-04 11:08:34.898 +07:00 [Information] Sending file. Request path: '"/Content/Admin/site.min.js"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\Content\Admin\site.min.js"'
2018-08-04 11:08:34.898 +07:00 [Information] Request finished in 5.2342ms 200 application/javascript
2018-08-04 11:08:35.312 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:08:35.342 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:08:35.412 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:08:35.446 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:08:35.479 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:08:35.515 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/favicon.ico  
2018-08-04 11:08:35.541 +07:00 [Information] Sending file. Request path: '"/favicon.ico"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\favicon.ico"'
2018-08-04 11:08:35.541 +07:00 [Information] Request finished in 25.8571ms 200 image/x-icon
2018-08-04 11:08:35.546 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:08:35.587 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:08:35.691 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:08:35.722 +07:00 [Information] Executed DbCommand ("8"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:08:35.724 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 311.8575ms.
2018-08-04 11:08:35.726 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:08:35.740 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 15.6438ms.
2018-08-04 11:08:35.741 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 398.4083ms
2018-08-04 11:08:35.741 +07:00 [Information] Request finished in 429.2539ms 200 text/html; charset=utf-8
2018-08-04 11:08:37.568 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:08:37.576 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:08:37.577 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:08:41.546 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 3970.5345ms
2018-08-04 11:08:42.692 +07:00 [Error] An unhandled exception has occurred while executing the request.
System.TypeInitializationException: The type initializer for 'GemBox.Spreadsheet.Styles.ColorScheme' threw an exception. ---> System.IO.FileNotFoundException: Could not load file or assembly 'System.Drawing.Common, Version=0.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51'. The system cannot find the file specified.
   at GemBox.Spreadsheet.Styles.ColorScheme..cctor()
   --- End of inner exception stack trace ---
   at GemBox.Spreadsheet.CellStyleCollection..ctor(FormatCache )
   at GemBox.Spreadsheet.ExcelFile..ctor()
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 99
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 11:08:42.818 +07:00 [Information] Request finished in 5249.7729ms 500 text/html; charset=utf-8
2018-08-04 11:08:54.302 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/  
2018-08-04 11:08:54.307 +07:00 [Information] Route matched with "{action = \"Index\", controller = \"Home\", area = \"\"}". Executing action "TN.UI.Controllers.HomeController.Index (TN.UI)"
2018-08-04 11:08:54.312 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:08:54.321 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 11:08:54.322 +07:00 [Information] Executing action method "TN.UI.Controllers.HomeController.Index (TN.UI)" - Validation state: Valid
2018-08-04 11:08:54.322 +07:00 [Information] Executed action method "TN.UI.Controllers.HomeController.Index (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 0.2787ms.
2018-08-04 11:08:54.332 +07:00 [Information] Executing ViewResult, running view "Index".
2018-08-04 11:08:54.344 +07:00 [Information] Executed ViewResult - view "Index" executed in 21.4685ms.
2018-08-04 11:08:54.344 +07:00 [Information] Executed action "TN.UI.Controllers.HomeController.Index (TN.UI)" in 36.8428ms
2018-08-04 11:08:54.344 +07:00 [Information] Request finished in 42.5745ms 200 text/html; charset=utf-8
2018-08-04 11:08:58.468 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth  
2018-08-04 11:08:58.475 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 11:08:58.476 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" - Validation state: Valid
2018-08-04 11:08:58.480 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:08:58.484 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:08:58.491 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:08:58.497 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 19.6281ms.
2018-08-04 11:08:58.499 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonth".
2018-08-04 11:08:58.546 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonth" executed in 48.6841ms.
2018-08-04 11:08:58.546 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 70.6031ms
2018-08-04 11:08:58.546 +07:00 [Information] Request finished in 78.1918ms 200 text/html; charset=utf-8
2018-08-04 11:08:58.890 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TotalTripsByMonth application/x-www-form-urlencoded; charset=UTF-8 57
2018-08-04 11:08:58.901 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TotalTripsByMonth\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)"
2018-08-04 11:08:58.903 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" with arguments (["0", "0", "1", ""]) - Validation state: Valid
2018-08-04 11:08:58.911 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:08:58.937 +07:00 [Information] Executed DbCommand ("12"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Aircon], [x].[Capacity], [x].[ContractEndDate], [x].[CreatedDate], [x].[CreatedUser], [x].[DeviceGPSId], [x].[DoorDown], [x].[DoorUp], [x].[DriverCode], [x].[Fuel], [x].[Heading], [x].[Ignition], [x].[IsAirConditioner], [x].[IsDelete], [x].[IsWorking], [x].[Lat], [x].[Lng], [x].[Lpn], [x].[Note], [x].[NumOfSeat], [x].[RegistryEndDate], [x].[SOS], [x].[Speed], [x].[Status], [x].[TrackingTime], [x].[TransportCompanyId], [x].[TransportCompanyStartDate], [x].[Type], [x].[UnderwriteEndDate], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleBrandId], [x].[VehicleFloorboardsTypeId], [x].[VehicleGroupId], [x].[YearOfManufacture]
FROM [Vehicle] AS [x]
WHERE [x].[TransportCompanyId] = @__transportCompanyId_0"
2018-08-04 11:08:59.057 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__month_1='?' (DbType = Int32), @__year_2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[VehicleId] AS [Key], COUNT(*) AS [Count]
FROM [ConfirmationTripsConfirm] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (DATEPART(month, [x].[CheckOutDate]) = @__month_1)) AND (DATEPART(year, [x].[CheckOutDate]) = @__year_2)
GROUP BY [x].[VehicleId]"
2018-08-04 11:08:59.068 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:08:59.079 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 176.5185ms.
2018-08-04 11:08:59.086 +07:00 [Information] Executing ViewResult, running view "TotalTripsByMonthAjax".
2018-08-04 11:08:59.091 +07:00 [Information] Executed ViewResult - view "TotalTripsByMonthAjax" executed in 11.6627ms.
2018-08-04 11:08:59.092 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TotalTripsByMonth (TN.UI)" in 190.1545ms
2018-08-04 11:08:59.092 +07:00 [Information] Request finished in 202.6586ms 200 text/html; charset=utf-8
2018-08-04 11:09:06.314 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 11:09:06.316 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:09:06.316 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:09:06.317 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:09:06.321 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:09:06.327 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:09:06.331 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 15.1555ms.
2018-08-04 11:09:06.332 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:09:06.334 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 2.4649ms.
2018-08-04 11:09:06.334 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 18.3098ms
2018-08-04 11:09:06.335 +07:00 [Information] Request finished in 20.7975ms 200 text/html; charset=utf-8
2018-08-04 11:09:06.597 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:09:06.598 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:09:06.599 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:09:06.599 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:09:06.603 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:09:06.614 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:09:06.620 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:09:06.635 +07:00 [Information] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:09:06.643 +07:00 [Information] Executed DbCommand ("7"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:09:06.644 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 44.9896ms.
2018-08-04 11:09:06.644 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:09:06.645 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.868ms.
2018-08-04 11:09:06.645 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 46.8917ms
2018-08-04 11:09:06.645 +07:00 [Information] Request finished in 48.5455ms 200 text/html; charset=utf-8
2018-08-04 11:09:07.543 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:09:07.544 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:09:07.545 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:09:07.547 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 2.3466ms
2018-08-04 11:09:07.551 +07:00 [Error] An unhandled exception has occurred while executing the request.
System.TypeInitializationException: The type initializer for 'GemBox.Spreadsheet.Styles.ColorScheme' threw an exception. ---> System.IO.FileNotFoundException: Could not load file or assembly 'System.Drawing.Common, Version=0.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51'. The system cannot find the file specified.
   at GemBox.Spreadsheet.Styles.ColorScheme..cctor()
   --- End of inner exception stack trace ---
   at GemBox.Spreadsheet.CellStyleCollection..ctor(FormatCache )
   at GemBox.Spreadsheet.ExcelFile..ctor()
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 99
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 11:09:07.569 +07:00 [Information] Request finished in 25.9831ms 500 text/html; charset=utf-8
2018-08-04 11:09:17.048 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 11:09:17.050 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:09:17.050 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:09:17.051 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:09:17.066 +07:00 [Information] Executed DbCommand ("15"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:09:17.074 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:09:17.082 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 32.0247ms.
2018-08-04 11:09:17.082 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:09:17.084 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 2.1952ms.
2018-08-04 11:09:17.085 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 34.9299ms
2018-08-04 11:09:17.085 +07:00 [Information] Request finished in 37.9996ms 200 text/html; charset=utf-8
2018-08-04 11:09:17.488 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:09:17.489 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:09:17.490 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:09:17.491 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:09:17.505 +07:00 [Information] Executed DbCommand ("12"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:09:17.516 +07:00 [Information] Executed DbCommand ("10"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:09:17.525 +07:00 [Information] Executed DbCommand ("8"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:09:17.541 +07:00 [Information] Executed DbCommand ("11"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:09:17.548 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:09:17.549 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 59.219ms.
2018-08-04 11:09:17.549 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:09:17.550 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.3076ms.
2018-08-04 11:09:17.550 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 60.5733ms
2018-08-04 11:09:17.550 +07:00 [Information] Request finished in 62.5798ms 200 text/html; charset=utf-8
2018-08-04 11:09:18.489 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:09:18.490 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:09:18.491 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:09:18.493 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 2.3386ms
2018-08-04 11:09:18.501 +07:00 [Error] An unhandled exception has occurred while executing the request.
System.TypeInitializationException: The type initializer for 'GemBox.Spreadsheet.Styles.ColorScheme' threw an exception. ---> System.IO.FileNotFoundException: Could not load file or assembly 'System.Drawing.Common, Version=0.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51'. The system cannot find the file specified.
   at GemBox.Spreadsheet.Styles.ColorScheme..cctor()
   --- End of inner exception stack trace ---
   at GemBox.Spreadsheet.CellStyleCollection..ctor(FormatCache )
   at GemBox.Spreadsheet.ExcelFile..ctor()
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 99
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 11:09:18.524 +07:00 [Information] Request finished in 34.7396ms 500 text/html; charset=utf-8
2018-08-04 11:11:07.716 +07:00 [Information] Request starting HTTP/1.1 DEBUG http://localhost:44396/  0
2018-08-04 11:11:07.716 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate  
2018-08-04 11:11:07.850 +07:00 [Information] Request finished in 135.3771ms 200 
2018-08-04 11:11:08.797 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:11:08.812 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:11:09.493 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:11:09.886 +07:00 [Information] Executed DbCommand ("62"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:11:10.033 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:11:10.078 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 1259.0863ms.
2018-08-04 11:11:10.106 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:11:10.302 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 205.4702ms.
2018-08-04 11:11:10.313 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 1511.7727ms
2018-08-04 11:11:10.378 +07:00 [Information] Request finished in 2638.2255ms 200 text/html; charset=utf-8
2018-08-04 11:11:10.793 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:11:10.841 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:11:10.847 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/favicon.ico  
2018-08-04 11:11:10.870 +07:00 [Information] Sending file. Request path: '"/favicon.ico"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\favicon.ico"'
2018-08-04 11:11:10.882 +07:00 [Information] Request finished in 37.5078ms 200 image/x-icon
2018-08-04 11:11:10.949 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:11:10.985 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:11:11.038 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:11:11.099 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:11:11.152 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:11:11.284 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:11:11.315 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:11:11.329 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 375.4697ms.
2018-08-04 11:11:11.335 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:11:11.344 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 11.3437ms.
2018-08-04 11:11:11.347 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 500.1478ms
2018-08-04 11:11:11.351 +07:00 [Information] Request finished in 563.1809ms 200 text/html; charset=utf-8
2018-08-04 11:11:22.764 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:11:22.775 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:11:22.783 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:11:23.757 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.FileStreamResult" in 970.9766ms.
2018-08-04 11:11:23.765 +07:00 [Information] Executing "Microsoft.AspNetCore.Mvc.FileStreamResult", sending file with download name '"243c73b5-9532-45e8-b75f-e43b7c26fb63.xlsx"' ...
2018-08-04 11:11:23.772 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 992.3961ms
2018-08-04 11:11:23.780 +07:00 [Information] Request finished in 1016.4186ms 200 application/x-msdownload
2018-08-04 11:11:24.038 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:11:24.054 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:11:24.061 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:11:24.065 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:11:24.076 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:11:24.088 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:11:24.097 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:11:24.108 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:11:24.116 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:11:24.122 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 57.4881ms.
2018-08-04 11:11:24.131 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:11:24.177 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 7.8645ms.
2018-08-04 11:11:24.230 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 153.7695ms
2018-08-04 11:11:24.266 +07:00 [Information] Request finished in 243.5575ms 200 text/html; charset=utf-8
2018-08-04 11:12:31.291 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate?page=1&date=04%2F08%2F2018&__RequestVerificationToken=CfDJ8JOj5I5192pEpD18VNpUHl12TXz941iFfl6XEYjC7rPf5rdpdDzFOyiV3nqVlU9pzRqBaEwJzvGfhPFSBqjATHwAC8GJQpivGPJsMicEIrHABKmfEygkOtFNrEvZw9MCQwX1MG0AvjH1MociSlracaheoB6J6FgKA-XDjH8QYvSjnC9kmLwfrQtez4l93EW7Bg&transportCompanyId=1&schoolId=  
2018-08-04 11:12:31.832 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:12:31.845 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:12:32.537 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:12:32.734 +07:00 [Information] Executed DbCommand ("17"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:12:32.854 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:12:32.888 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 1039.3698ms.
2018-08-04 11:12:32.934 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:12:33.131 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 228.5812ms.
2018-08-04 11:12:33.134 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 1301.6713ms
2018-08-04 11:12:33.153 +07:00 [Information] Request finished in 1868.6259ms 200 text/html; charset=utf-8
2018-08-04 11:12:33.257 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate?page=1&date=04%2F08%2F2018&__RequestVerificationToken=CfDJ8JOj5I5192pEpD18VNpUHl12TXz941iFfl6XEYjC7rPf5rdpdDzFOyiV3nqVlU9pzRqBaEwJzvGfhPFSBqjATHwAC8GJQpivGPJsMicEIrHABKmfEygkOtFNrEvZw9MCQwX1MG0AvjH1MociSlracaheoB6J6FgKA-XDjH8QYvSjnC9kmLwfrQtez4l93EW7Bg&transportCompanyId=1&schoolId=  
2018-08-04 11:12:33.263 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:12:33.264 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:12:33.265 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:12:33.279 +07:00 [Information] Executed DbCommand ("8"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:12:33.286 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:12:33.291 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 27.3203ms.
2018-08-04 11:12:33.292 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:12:33.297 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 4.8633ms.
2018-08-04 11:12:33.297 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 33.1599ms
2018-08-04 11:12:33.298 +07:00 [Information] Request finished in 42.3519ms 200 text/html; charset=utf-8
2018-08-04 11:12:33.829 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:12:33.868 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:12:33.959 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:12:33.992 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:12:34.021 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:12:34.064 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:12:34.103 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:12:34.221 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:12:34.266 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:12:34.276 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 316.5345ms.
2018-08-04 11:12:34.278 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:12:34.288 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 11.5503ms.
2018-08-04 11:12:34.288 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 420.3327ms
2018-08-04 11:12:34.289 +07:00 [Information] Request finished in 459.9319ms 200 text/html; charset=utf-8
2018-08-04 11:12:36.137 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:12:36.154 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:12:36.156 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:12:36.679 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.FileStreamResult" in 523.2134ms.
2018-08-04 11:12:36.681 +07:00 [Information] Executing "Microsoft.AspNetCore.Mvc.FileStreamResult", sending file with download name '"566907cb-4b87-4bd4-8c3f-9d6dac0534ae.xlsx"' ...
2018-08-04 11:12:36.684 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 529.4476ms
2018-08-04 11:12:36.685 +07:00 [Information] Request finished in 547.6963ms 200 application/x-msdownload
2018-08-04 11:12:36.908 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:12:36.912 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:12:36.912 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:12:36.918 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:12:36.925 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:12:36.930 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:12:36.934 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:12:36.943 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:12:36.949 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:12:36.949 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 36.6687ms.
2018-08-04 11:12:36.949 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:12:36.950 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.2827ms.
2018-08-04 11:12:36.950 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 37.7073ms
2018-08-04 11:12:36.950 +07:00 [Information] Request finished in 42.9787ms 200 text/html; charset=utf-8
2018-08-04 11:14:12.658 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate?page=1&date=04%2F08%2F2018&__RequestVerificationToken=CfDJ8JOj5I5192pEpD18VNpUHl04z51PMYrwvFIjFMN8tAvDJnsa5k5OBecChoYzc2ZplKC3dv918yLmes43pO453MLBSghan1zpGwQcKhXC358ZDcqFJ6BMgHhPcqTMYXT4sUMbtrv-OKvc5CXw-6KbfSH8qHsNl_naQHH4lSHJllq0avNpBaeuu9oz2JqB09CWXw&transportCompanyId=1&schoolId=  
2018-08-04 11:14:13.258 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:14:13.271 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:14:13.778 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:14:13.974 +07:00 [Information] Executed DbCommand ("19"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:14:14.075 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:14:14.113 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 838.2727ms.
2018-08-04 11:14:14.132 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:14:14.301 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 175.8139ms.
2018-08-04 11:14:14.304 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 1045.2493ms
2018-08-04 11:14:14.342 +07:00 [Information] Request finished in 1689.9907ms 200 text/html; charset=utf-8
2018-08-04 11:14:14.625 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:14:14.666 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:14:14.670 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/favicon.ico  
2018-08-04 11:14:14.678 +07:00 [Information] Sending file. Request path: '"/favicon.ico"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\favicon.ico"'
2018-08-04 11:14:14.678 +07:00 [Information] Request finished in 7.879ms 200 image/x-icon
2018-08-04 11:14:14.726 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:14:14.749 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:14:14.776 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:14:14.818 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:14:14.858 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:14:14.944 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:14:14.979 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:14:14.991 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 264.552ms.
2018-08-04 11:14:14.993 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:14:15.005 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 12.8981ms.
2018-08-04 11:14:15.005 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 338.7984ms
2018-08-04 11:14:15.006 +07:00 [Information] Request finished in 381.1988ms 200 text/html; charset=utf-8
2018-08-04 11:15:36.177 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:15:37.352 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:15:37.452 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:15:37.670 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 312.5714ms
2018-08-04 11:15:37.725 +07:00 [Error] An unhandled exception has occurred while executing the request.
System.ArgumentException: The worksheet name is not unique case-insensitive name.
Parameter name: worksheetName
   at GemBox.Spreadsheet.ExcelWorksheetCollection.(String )
   at GemBox.Spreadsheet.ExcelWorksheetCollection.(SheetType , String , Int32 )
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 104
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 11:15:37.781 +07:00 [Information] Request finished in 1609.782ms 500 text/html; charset=utf-8
2018-08-04 11:15:47.640 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate?page=1&date=04%2F08%2F2018&__RequestVerificationToken=CfDJ8JOj5I5192pEpD18VNpUHl04z51PMYrwvFIjFMN8tAvDJnsa5k5OBecChoYzc2ZplKC3dv918yLmes43pO453MLBSghan1zpGwQcKhXC358ZDcqFJ6BMgHhPcqTMYXT4sUMbtrv-OKvc5CXw-6KbfSH8qHsNl_naQHH4lSHJllq0avNpBaeuu9oz2JqB09CWXw&transportCompanyId=1&schoolId=  
2018-08-04 11:15:47.655 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:15:47.666 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:15:48.294 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:15:48.555 +07:00 [Information] Executed DbCommand ("23"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:15:48.656 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:15:48.691 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 1021.429ms.
2018-08-04 11:15:48.712 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:15:48.869 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 167.6425ms.
2018-08-04 11:15:48.873 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 1217.8393ms
2018-08-04 11:15:48.918 +07:00 [Information] Request finished in 1279.1395ms 200 text/html; charset=utf-8
2018-08-04 11:15:49.294 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:15:49.313 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:15:49.316 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:15:49.354 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:15:49.399 +07:00 [Information] Executed DbCommand ("8"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:15:49.464 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:15:49.513 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:15:49.674 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:15:49.714 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:15:49.730 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 411.2382ms.
2018-08-04 11:15:49.736 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:15:49.742 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 11.8433ms.
2018-08-04 11:15:49.747 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 428.9787ms
2018-08-04 11:15:49.747 +07:00 [Information] Request finished in 453.3152ms 200 text/html; charset=utf-8
2018-08-04 11:15:50.806 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:15:50.808 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:15:50.809 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:15:50.812 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 4.0665ms
2018-08-04 11:15:50.818 +07:00 [Error] An unhandled exception has occurred while executing the request.
System.ArgumentException: The worksheet name is not unique case-insensitive name.
Parameter name: worksheetName
   at GemBox.Spreadsheet.ExcelWorksheetCollection.(String )
   at GemBox.Spreadsheet.ExcelWorksheetCollection.(SheetType , String , Int32 )
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 104
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 11:15:50.828 +07:00 [Information] Request finished in 23.0741ms 500 text/html; charset=utf-8
2018-08-04 11:16:31.020 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate?page=1&date=04%2F08%2F2018&__RequestVerificationToken=CfDJ8JOj5I5192pEpD18VNpUHl04z51PMYrwvFIjFMN8tAvDJnsa5k5OBecChoYzc2ZplKC3dv918yLmes43pO453MLBSghan1zpGwQcKhXC358ZDcqFJ6BMgHhPcqTMYXT4sUMbtrv-OKvc5CXw-6KbfSH8qHsNl_naQHH4lSHJllq0avNpBaeuu9oz2JqB09CWXw&transportCompanyId=1&schoolId=  
2018-08-04 11:16:31.541 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 11:16:31.554 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 11:16:32.058 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:16:32.265 +07:00 [Information] Executed DbCommand ("25"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:16:32.364 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 11:16:32.400 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 839.9741ms.
2018-08-04 11:16:32.419 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 11:16:32.590 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 177.3003ms.
2018-08-04 11:16:32.594 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 1052.0778ms
2018-08-04 11:16:32.634 +07:00 [Information] Request finished in 1617.7867ms 200 text/html; charset=utf-8
2018-08-04 11:16:32.642 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.css?v=HnGJCmFp085jz-PBZzJQGxFv8j-3K6sYswpGTxksm5g  
2018-08-04 11:16:32.646 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.js  
2018-08-04 11:16:32.675 +07:00 [Information] Sending file. Request path: '"/Content/Admin/site.min.js"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\Content\Admin\site.min.js"'
2018-08-04 11:16:32.676 +07:00 [Information] Request finished in 29.2434ms 200 application/javascript
2018-08-04 11:16:32.676 +07:00 [Information] Sending file. Request path: '"/Content/Admin/site.min.css"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\Content\Admin\site.min.css"'
2018-08-04 11:16:32.676 +07:00 [Information] Request finished in 34.5117ms 200 text/css
2018-08-04 11:16:33.027 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 11:16:33.061 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 11:16:33.154 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:16:33.191 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 11:16:33.241 +07:00 [Information] Executed DbCommand ("13"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 11:16:33.298 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 11:16:33.348 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 11:16:33.465 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 11:16:33.502 +07:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 11:16:33.517 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 360.5848ms.
2018-08-04 11:16:33.521 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 11:16:33.526 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 7.4883ms.
2018-08-04 11:16:33.527 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 465.9356ms
2018-08-04 11:16:33.527 +07:00 [Information] Request finished in 500.4109ms 200 text/html; charset=utf-8
2018-08-04 11:16:35.425 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 11:16:35.433 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 11:16:35.434 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 11:16:35.806 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 373.2593ms
2018-08-04 11:16:35.839 +07:00 [Error] An unhandled exception has occurred while executing the request.
GemBox.Spreadsheet.FreeLimitReachedException: Free version limitation has been exceeded (Free version is limited to 150 rows and 5 sheets). To control what happens when your application reaches free version limit use SpreadsheetInfo.FreeLimitReached event. For more information about evaluation, see: https://www.gemboxsoftware.com/spreadsheet/help/html/Evaluation_and_Licensing.htm#Evaluation.
   at GemBox.Spreadsheet.SpreadsheetInfo.()
   at   . ()
   at ​ .(   )
   at ​ .    ()
   at GemBox.Spreadsheet.XlsxSaveOptions.(ExcelFile , Stream )
   at GemBox.Spreadsheet.SaveOptions.(ExcelFile , String )
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 108
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 11:16:35.865 +07:00 [Information] Request finished in 440.7125ms 500 text/html; charset=utf-8
2018-08-04 12:16:03.300 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate?page=1&date=04%2F08%2F2018&__RequestVerificationToken=CfDJ8JOj5I5192pEpD18VNpUHl04z51PMYrwvFIjFMN8tAvDJnsa5k5OBecChoYzc2ZplKC3dv918yLmes43pO453MLBSghan1zpGwQcKhXC358ZDcqFJ6BMgHhPcqTMYXT4sUMbtrv-OKvc5CXw-6KbfSH8qHsNl_naQHH4lSHJllq0avNpBaeuu9oz2JqB09CWXw&transportCompanyId=1&schoolId=  
2018-08-04 12:16:04.037 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 12:16:04.234 +07:00 [Information] Executed DbCommand ("16"ms) [Parameters=["@__get_Item_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Avatar], [e].[ConcurrencyStamp], [e].[CreatedDate], [e].[CreatedUserId], [e].[DisplayName], [e].[Email], [e].[EmailConfirmed], [e].[IsLock], [e].[IsReLogin], [e].[IsSuperAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[Note], [e].[NoteLock], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[RoleParents], [e].[RoleSchool], [e].[RoleTransportCompany], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UpdatedDate], [e].[UpdatedUserId], [e].[UserName]
FROM [adm].[User] AS [e]
WHERE [e].[Id] = @__get_Item_0"
2018-08-04 12:16:04.400 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__user_Id_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [adm].[UserClaim] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0"
2018-08-04 12:16:04.434 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__userId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[ConcurrencyStamp], [x].[Description], [x].[Name], [x].[NormalizedName], [x].[Type]
FROM [adm].[Role] AS [x]
WHERE EXISTS (
    SELECT 1
    FROM [adm].[UserRole] AS [m]
    WHERE ([m].[UserId] = @__userId_0) AND ([m].[RoleId] = [x].[Id]))"
2018-08-04 12:16:04.856 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 12:16:04.870 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 12:16:04.888 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 12:16:04.938 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 12:16:04.975 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 100.9528ms.
2018-08-04 12:16:05.008 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 12:16:05.184 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 195.463ms.
2018-08-04 12:16:05.187 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 331.5136ms
2018-08-04 12:16:05.218 +07:00 [Information] Request finished in 1922.937ms 200 text/html; charset=utf-8
2018-08-04 12:16:05.254 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.css?v=HnGJCmFp085jz-PBZzJQGxFv8j-3K6sYswpGTxksm5g  
2018-08-04 12:16:05.259 +07:00 [Information] The file "/Content/Admin/site.min.css" was not modified
2018-08-04 12:16:05.262 +07:00 [Information] Request finished in 9.8734ms 304 text/css
2018-08-04 12:16:05.302 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Content/Admin/site.min.js  
2018-08-04 12:16:05.304 +07:00 [Information] The file "/Content/Admin/site.min.js" was not modified
2018-08-04 12:16:05.304 +07:00 [Information] Request finished in 2.0353ms 304 application/javascript
2018-08-04 12:16:05.677 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 12:16:05.703 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 12:16:05.720 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/favicon.ico  
2018-08-04 12:16:05.724 +07:00 [Information] Sending file. Request path: '"/favicon.ico"'. Physical path: '"D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\wwwroot\favicon.ico"'
2018-08-04 12:16:05.724 +07:00 [Information] Request finished in 3.4918ms 200 image/x-icon
2018-08-04 12:16:05.781 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 12:16:05.801 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 12:16:05.825 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 12:16:05.869 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 12:16:05.905 +07:00 [Information] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 12:16:05.993 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 12:16:06.018 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 12:16:06.023 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 240.4813ms.
2018-08-04 12:16:06.054 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 12:16:06.065 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 39.9822ms.
2018-08-04 12:16:06.065 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 362.0828ms
2018-08-04 12:16:06.066 +07:00 [Information] Request finished in 389.5045ms 200 text/html; charset=utf-8
2018-08-04 12:16:07.444 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 12:16:07.450 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 12:16:07.451 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 12:16:08.263 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 813.4564ms
2018-08-04 12:16:08.371 +07:00 [Error] An unhandled exception has occurred while executing the request.
System.IO.FileNotFoundException: Could not find file 'D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Export\Files\6c2f38bc-27a2-4cbf-80e4-d0dce97f3282.xlsx'.
File name: 'D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Export\Files\6c2f38bc-27a2-4cbf-80e4-d0dce97f3282.xlsx'
   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)
   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)
   at System.IO.FileStream..ctor(String path, FileMode mode)
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 164
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 12:16:08.405 +07:00 [Information] Request finished in 960.3569ms 500 text/html; charset=utf-8
2018-08-04 12:16:16.857 +07:00 [Information] Request starting HTTP/1.1 GET http://localhost:44396/Admin/Report/TripsReport/TripsByDate?page=1&date=04%2F08%2F2018&__RequestVerificationToken=CfDJ8JOj5I5192pEpD18VNpUHl04z51PMYrwvFIjFMN8tAvDJnsa5k5OBecChoYzc2ZplKC3dv918yLmes43pO453MLBSghan1zpGwQcKhXC358ZDcqFJ6BMgHhPcqTMYXT4sUMbtrv-OKvc5CXw-6KbfSH8qHsNl_naQHH4lSHJllq0avNpBaeuu9oz2JqB09CWXw&transportCompanyId=1&schoolId=  
2018-08-04 12:16:16.860 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)"
2018-08-04 12:16:16.861 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" - Validation state: Valid
2018-08-04 12:16:16.862 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 12:16:16.868 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 12:16:16.878 +07:00 [Information] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DistrictId], [x].[Image], [x].[IsDelete], [x].[Lat], [x].[Lng], [x].[Name], [x].[Note], [x].[Status], [x].[Trips], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [School] AS [x]
WHERE ([x].[Status] = 1) AND ([x].[IsDelete] = 0)"
2018-08-04 12:16:16.889 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 27.0686ms.
2018-08-04 12:16:16.890 +07:00 [Information] Executing ViewResult, running view "TripsByDate".
2018-08-04 12:16:16.898 +07:00 [Information] Executed ViewResult - view "TripsByDate" executed in 8.4023ms.
2018-08-04 12:16:16.898 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDate (TN.UI)" in 37.4949ms
2018-08-04 12:16:16.898 +07:00 [Information] Request finished in 41.6017ms 200 text/html; charset=utf-8
2018-08-04 12:16:17.425 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDate application/x-www-form-urlencoded; charset=UTF-8 283
2018-08-04 12:16:17.426 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDate\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)"
2018-08-04 12:16:17.429 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 12:16:17.432 +07:00 [Information] Entity Framework Core "2.1.1-rtm-30846" initialized '"ApplicationContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "None"
2018-08-04 12:16:17.452 +07:00 [Information] Executed DbCommand ("14"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32), @__date_Date_1='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SELECT [x].[Id], [x].[ConfimCenterUser], [x].[ConfirmCenterTime], [x].[CreatedDate], [x].[CreatedUser], [x].[Date], [x].[IsConfirmCenter], [x].[IsDelete], [x].[IsNotification], [x].[IsSendEmailCenter], [x].[IsSendEmailTransportCompany], [x].[RouteId], [x].[SendEmailDateCenter], [x].[SendEmailDateTransportCompany], [x].[TimeTable], [x].[TransportCompanyId], [x].[UpdatedDate], [x].[UpdatedUser], [x].[VehicleId]
FROM [ConfirmationTrips] AS [x]
WHERE (([x].[TransportCompanyId] = @__transportCompanyId_0) AND (CONVERT(date, [x].[Date]) = @__date_Date_1)) AND ([x].[IsConfirmCenter] = 1)"
2018-08-04 12:16:17.460 +07:00 [Information] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[Aircon], [m].[Capacity], [m].[ContractEndDate], [m].[CreatedDate], [m].[CreatedUser], [m].[DeviceGPSId], [m].[DoorDown], [m].[DoorUp], [m].[DriverCode], [m].[Fuel], [m].[Heading], [m].[Ignition], [m].[IsAirConditioner], [m].[IsDelete], [m].[IsWorking], [m].[Lat], [m].[Lng], [m].[Lpn], [m].[Note], [m].[NumOfSeat], [m].[RegistryEndDate], [m].[SOS], [m].[Speed], [m].[Status], [m].[TrackingTime], [m].[TransportCompanyId], [m].[TransportCompanyStartDate], [m].[Type], [m].[UnderwriteEndDate], [m].[UpdatedDate], [m].[UpdatedUser], [m].[VehicleBrandId], [m].[VehicleFloorboardsTypeId], [m].[VehicleGroupId], [m].[YearOfManufacture]
FROM [Vehicle] AS [m]
WHERE 0 = 1"
2018-08-04 12:16:17.469 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id], [m].[CheckOutEndTime], [m].[CheckOutStartTime], [m].[ConfirmationTripsId], [m].[CreatedDate], [m].[EndStationId], [m].[EndTime], [m].[IsCheckOutEndStation], [m].[IsCheckOutStartStation], [m].[LatEndStation], [m].[LatGPSEndStation], [m].[LatGPSStartStation], [m].[LatStartStation], [m].[LngStartStation], [m].[LngtEndStation], [m].[LngtGPSEndStation], [m].[LngtGPSStartStation], [m].[RouteId], [m].[StartStationId], [m].[StartTime], [m].[Status], [m].[TimeTable]
FROM [ConfirmationTripsDetail] AS [m]
WHERE 0 = 1"
2018-08-04 12:16:17.486 +07:00 [Information] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [m].[Id] AS [CheckOutId], [m].[StudentId], [student].[FullName] AS [StudentName], [classOfSchool].[Name] AS [ClassOfSchoolName], [school].[Name] AS [SchoolName], [m].[CheckOutDate]
FROM [ConfirmationTripsConfirm] AS [m]
LEFT JOIN [Student] AS [student] ON [m].[StudentId] = [student].[Id]
LEFT JOIN [ClassOfSchool] AS [classOfSchool] ON [m].[ClassOfSchoolId] = [classOfSchool].[Id]
LEFT JOIN [School] AS [school] ON [m].[SchoolId] = [school].[Id]
WHERE 0 = 1"
2018-08-04 12:16:17.491 +07:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__transportCompanyId_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [x].[Id], [x].[Address], [x].[Code], [x].[CreatedDate], [x].[CreatedUser], [x].[DateIssued], [x].[Email], [x].[IsDelete], [x].[Name], [x].[Note], [x].[PhoneFax], [x].[Status], [x].[UpdatedDate], [x].[UpdatedUser]
FROM [TransportCompany] AS [x]
WHERE [x].[Id] = @__transportCompanyId_0"
2018-08-04 12:16:17.492 +07:00 [Information] Executed action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)", returned result "Microsoft.AspNetCore.Mvc.ViewResult" in 61.4558ms.
2018-08-04 12:16:17.493 +07:00 [Information] Executing ViewResult, running view "TripsByDateAjax".
2018-08-04 12:16:17.493 +07:00 [Information] Executed ViewResult - view "TripsByDateAjax" executed in 0.7766ms.
2018-08-04 12:16:17.499 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDatePost (TN.UI)" in 67.3927ms
2018-08-04 12:16:17.500 +07:00 [Information] Request finished in 75.0111ms 200 text/html; charset=utf-8
2018-08-04 12:16:18.196 +07:00 [Information] Request starting HTTP/1.1 POST http://localhost:44396/Admin/Report/TripsReport/TripsByDateExport application/x-www-form-urlencoded; charset=UTF-8 276
2018-08-04 12:16:18.198 +07:00 [Information] Route matched with "{area = \"Report\", action = \"TripsByDateExport\", controller = \"TripsReport\"}". Executing action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)"
2018-08-04 12:16:18.198 +07:00 [Information] Executing action method "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" with arguments (["04/08/2018", "1", ""]) - Validation state: Valid
2018-08-04 12:16:18.230 +07:00 [Information] Executed action "TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost (TN.UI)" in 32.1502ms
2018-08-04 12:16:18.236 +07:00 [Error] An unhandled exception has occurred while executing the request.
System.IO.FileNotFoundException: Could not find file 'D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Export\Files\48e827d8-c3a3-4a00-9d93-d69238d3e2cc.xlsx'.
File name: 'D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Export\Files\48e827d8-c3a3-4a00-9d93-d69238d3e2cc.xlsx'
   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)
   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)
   at System.IO.FileStream..ctor(String path, FileMode mode)
   at TN.UI.Areas.Report.Controllers.TripsReportController.TripsByDateExportPost(String date, Nullable`1 transportCompanyId, Nullable`1 schoolId) in D:\2018\1.BusStudent\Sources\Code\Backend\TN.UI\Areas\Report\Controllers\TripsReportController.cs:line 164
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-04 12:16:18.263 +07:00 [Information] Request finished in 66.9901ms 500 text/html; charset=utf-8
